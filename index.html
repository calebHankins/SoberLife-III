<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üßò SoberLife - III üßò</title>
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
</head>

<body>
    <div class="game-container">
        <h1>üßò SoberLife - III üßò</h1>

        <!-- Avatar and Stress Meter -->
        <div class="avatar-container">
            <div class="avatar" id="avatar">üòä</div>
            <div>
                <div>Stress Level</div>
                <div class="stress-meter">
                    <div class="stress-fill" id="stressFill"></div>
                </div>
                <div class="zen-points" id="zenPoints">Zen Points: 100</div>
            </div>
        </div>

        <!-- Survey Section -->
        <div class="survey" id="surveySection">
            <h3>Pre-Task Assessment</h3>
            <p>Before we begin your DMV visit, let's assess your current stress level:</p>

            <div class="survey-question">
                <strong>How did you sleep last night?</strong>
                <label><input type="radio" name="sleep" value="0"> Great! 8+ hours of solid sleep</label>
                <label><input type="radio" name="sleep" value="10"> Pretty well, 6-8 hours</label>
                <label><input type="radio" name="sleep" value="20"> Not great, 4-6 hours</label>
                <label><input type="radio" name="sleep" value="30"> Terrible, less than 4 hours</label>
            </div>

            <div class="survey-question">
                <strong>How prepared do you feel for the DMV?</strong>
                <label><input type="radio" name="prepared" value="0"> Very prepared, all documents ready</label>
                <label><input type="radio" name="prepared" value="10"> Mostly prepared</label>
                <label><input type="radio" name="prepared" value="20"> Somewhat prepared</label>
                <label><input type="radio" name="prepared" value="30"> Not prepared at all</label>
            </div>

            <div class="survey-question">
                <strong>How's your day been so far?</strong>
                <label><input type="radio" name="day" value="0"> Amazing, everything's going smoothly</label>
                <label><input type="radio" name="day" value="10"> Pretty good</label>
                <label><input type="radio" name="day" value="20"> Okay, some minor issues</label>
                <label><input type="radio" name="day" value="30"> Stressful, lots of problems</label>
            </div>

            <div id="surveyError" style="color: red; font-weight: bold; margin: 10px 0; display: none;">
                Please answer all questions before beginning your DMV visit!
            </div>
            <button id="startGameBtn" onclick="startGame()" disabled>Begin DMV Visit</button>
        </div>

        <!-- Task Info -->
        <div class="task-info hidden" id="taskInfo">
            <h3>üèõÔ∏è Task: DMV License Renewal & Real ID</h3>
            <p id="taskDescription">Step 1: Check in at the front desk</p>
            <p>Complete each step by getting closer to 21 than the house without going over!</p>
        </div>

        <!-- Zen Activities Panel -->
        <div class="zen-activities hidden" id="zenActivities">
            <h3>üßò Stress Relief Activities</h3>
            <p>Use your zen points to manage stress during your DMV visit:</p>
            <div class="activity-buttons">
                <button class="activity-btn" onclick="useZenActivity('breath')" id="breathBtn">
                    üå¨Ô∏è Deep Breath<br>
                    <small>10 zen points ‚Ä¢ -10% stress</small>
                </button>
                <button class="activity-btn" onclick="useZenActivity('stretch')" id="stretchBtn">
                    ü§∏ Quick Stretch<br>
                    <small>25 zen points ‚Ä¢ -20% stress</small>
                </button>
                <button class="activity-btn" onclick="useZenActivity('meditation')" id="meditationBtn">
                    üßò Mini Meditation<br>
                    <small>50 zen points ‚Ä¢ -35% stress</small>
                </button>
            </div>
        </div>

        <!-- Game Area -->
        <div class="game-area hidden" id="gameArea">
            <div class="cards-container">
                <div class="player-area">
                    <h3>You</h3>
                    <div class="cards" id="playerCards"></div>
                    <div class="score" id="playerScore">Score: 0</div>
                </div>
                <div class="house-area">
                    <h3>House</h3>
                    <div class="cards" id="houseCards"></div>
                    <div class="score" id="houseScore">Score: ?</div>
                </div>
            </div>

            <div class="buttons">
                <button id="hitBtn" onclick="hit()">Hit</button>
                <button id="standBtn" onclick="stand()">Stand</button>
                <button id="nextStepBtn" onclick="nextStep()" class="hidden">Next Step</button>
            </div>

            <div id="roundResult"></div>
        </div>

        <!-- Game Over Screen -->
        <div class="game-over hidden" id="gameOverScreen">
            <div class="game-over-content">
                <div class="game-over-avatar">ü§Ø</div>
                <h2>STRESS OVERLOAD!</h2>
                <p class="game-over-message">You've reached maximum stress levels and had a complete meltdown at the DMV!</p>
                <p class="game-over-subtext">Don't worry, it happens to the best of us. The DMV is basically designed to test human patience limits.</p>
                
                <div class="game-over-stats">
                    <p>Final Stress Level: <span id="finalStressLevel">100%</span></p>
                    <p>Zen Points Remaining: <span id="finalZenPoints">0</span></p>
                    <p>DMV Steps Completed: <span id="stepsCompleted">0</span>/5</p>
                </div>
                
                <button id="tryAgainBtn" onclick="restartGame()">Try Again</button>
            </div>
        </div>

        <!-- Game Success Screen -->
        <div class="game-success hidden" id="gameSuccessScreen">
            <div class="game-success-content">
                <div class="game-success-avatar">üéâ</div>
                <h2 id="successMessage">Congratulations!</h2>
                <p class="game-success-message" id="successSubtext">You successfully completed your DMV visit!</p>
                
                <div class="game-success-stats" id="successStats">
                    <p>Final Stress Level: 25%</p>
                    <p>Zen Points Remaining: 75</p>
                    <p>DMV Steps Completed: 5/5</p>
                </div>
                
                <button id="playAgainBtn" onclick="restartGame()">Play Again</button>
            </div>
        </div>
    </div>

    <!-- External JavaScript Files -->
    <script type="module" src="assets/js/main.js"></script>
    <script type="module">
        // Import zen activity function for global access
        import { useZenActivity } from './assets/js/stress-system.js';
        window.useZenActivity = useZenActivity;
    </script>
</body>

</html>